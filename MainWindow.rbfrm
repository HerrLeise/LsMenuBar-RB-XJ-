#tag WindowBegin Window MainWindow   BackColor       =   &hFFFFFF   Backdrop        =   ""   CloseButton     =   True   Composite       =   True   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   400   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   1457369314   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   2   Resizeable      =   True   Title           =   "LsMenuBar TestWindow"   Visible         =   True   Width           =   600   Begin LsMenuBar myLsToolBar      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      BehaveAsToolBar =   True      BorderWidth     =   1      BottomRightColor=   13158600      DoubleBuffer    =   True      Enabled         =   True      EraseBackground =   True      FillColor       =   15921906      hasBorder       =   True      hasHelpTag      =   True      Height          =   38      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      isActive        =   ""      ItemHighlightColor=   1601983      ItemHoverColor  =   15000804      lastX           =   0      lastY           =   0      Left            =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      mC              =   0      MouseInside     =   ""      MouseX          =   0      MouseY          =   0      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   0      TextFont        =   "Calibri"      TextHighlightColor=   16777215      TextSize        =   15      ToolBarItemBorderColor=   13158600      Top             =   30      TopLeftBorderColor=   13158600      UseFocusRing    =   True      Visible         =   True      Width           =   600   End   Begin LsMenuBar myLsMenuBar      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      BehaveAsToolBar =   False      BorderWidth     =   1      BottomRightColor=   13158600      DoubleBuffer    =   True      Enabled         =   True      EraseBackground =   True      FillColor       =   15921906      hasBorder       =   True      hasHelpTag      =   False      Height          =   31      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      isActive        =   ""      ItemHighlightColor=   1601983      ItemHoverColor  =   15000804      lastX           =   0      lastY           =   0      Left            =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      mC              =   0      MouseInside     =   ""      MouseX          =   0      MouseY          =   0      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   0      TextFont        =   "Calibri"      TextHighlightColor=   16777215      TextSize        =   16      ToolBarItemBorderColor=   13158600      Top             =   0      TopLeftBorderColor=   13158600      UseFocusRing    =   True      Visible         =   True      Width           =   600   End   Begin Listbox console      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   1      ColumnsResizable=   ""      ColumnWidths    =   ""      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   -1      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   ""      HeadingIndex    =   -1      Height          =   100      HelpTag         =   ""      Hierarchical    =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      RequiresSelection=   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollBarVertical=   True      SelectionType   =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   280      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   560      _ScrollWidth    =   -1   End   Begin TextArea TextArea1      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   16777215      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   145      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      Italic          =   ""      Left            =   20      LimitText       =   0      LineHeight      =   0      LineSpacing     =   1      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Mask            =   ""      Multiline       =   True      ReadOnly        =   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   123      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   166   End   Begin BevelButton BevelButton1      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   0      Bevel           =   0      Bold            =   False      ButtonType      =   0      Caption         =   "Del Open SUbmenu"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   False      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   220      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      MenuValue       =   0      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   0      TextFont        =   "System"      TextSize        =   ""      TextUnit        =   0      Top             =   123      Underline       =   False      Value           =   False      Visible         =   True      Width           =   160   End   Begin BevelButton BevelButton2      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   0      Bevel           =   0      Bold            =   False      ButtonType      =   0      Caption         =   "Add SubMenu"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   False      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   220      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      MenuValue       =   0      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   0      TextFont        =   "System"      TextSize        =   ""      TextUnit        =   0      Top             =   157      Underline       =   False      Value           =   False      Visible         =   True      Width           =   160   End   Begin Label Label1      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   19      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   6      TabPanelIndex   =   0      Text            =   "Add File Submenu"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   99      Transparent     =   True      Underline       =   ""      Visible         =   True      Width           =   167   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  //at first we need to setup the Menubars		  		  Init_MenuBars()		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Init_MenuBars()		  //		  //Set Up the MenuBar		  Dim FileMenu As New LsMenuItem("Datei","File","TB_File")		  		  Dim nFile As New MenuItem("Neu")		  nFile.KeyboardShortcut = "Cmd+N"		  		  FileMenu.AddItem(nFile)		  		  Dim OpenMenu As New LsMenuItem("Öffnen","Open","TB_Open")		  OpenMenu.Append(New MenuItem(".csv"))		  OpenMenu.Append(New MenuItem(".xml"))		  FileMenu.AddItem(OpenMenu)		  		  FileMenu.AddItem(New MenuItem(MenuItem.TextSeparator))		  FileMenu.AddItem(New MenuItem("Beenden"))		  		  Dim EditMenu As New LsMenuItem("Bearbeiten","Edit","TB_Edit")		  Dim iUndo As New MenuItem("Rückgängig")		  iUndo.KeyboardShortcut = "Cmd+Z"		  EditMenu.AddItem(iUndo)		  Dim iRedo As New MenuItem("Wiederholen")		  iRedo.KeyboardShortcut = "Cmd+Y"		  EditMenu.AddItem(iRedo)		  EditMenu.AddItem(New MenuItem(MenuItem.TextSeparator))		  EditMenu.AddItem(New MenuItem("Bla Bla Bla"))		  		  Dim ViewMenu As New LsMenuItem("Ansicht","View","TB_View")		  ViewMenu.AddItem(New MenuItem("You will never"))		  ViewMenu.AddItem(New MenuItem("be better than me!"))		  ViewMenu.AddItem(New MenuItem(MenuItem.TextSeparator))		  ViewMenu.AddItem(New MenuItem("I promise!"))		  		  myLsMenuBar.AddBaseMenu(New LsMenuItem(FileMenu))		  myLsMenuBar.AddBaseMenu(New LsMenuItem(EditMenu))		  myLsMenuBar.AddBaseMenu(New LsMenuItem(ViewMenu))		  		  myLsMenuBar.isActive = true		  myLsMenuBar.Refresh()		  		  		  		  //		  //Setup the ToolBar		  DIm tBI As New LsMenuItem("Do something","DS","TB_DS")		  tbI.isToolBarItem = True		  tBI.ToolbarIcon = glass		  DIm tBIx As New LsMenuItem("Tralala","TR","TB_TR")		  tbIx.isToolBarItem = True		  tBIx.ToolbarIcon = envelope		  tBIx.GroupID = "TestGroup"		  DIm tBIy As New LsMenuItem("Hello","Hello","TB_Hello")		  tbIy.isToolBarItem = True		  tBIy.isPopUpMenu = True		  tBIy.ToolbarIcon = chartpieseparate		  tBIy.AddItem(New MenuItem(".A"))		  tBIy.AddItem(New MenuItem(".B"))		  		  DIm tBIz As New LsMenuItem("Icon","Ico","TB_Ico")		  tbIz.isToolBarItem = True		  tbIz.showCaption = True		  tBIz.isPopUpBox = True		  tBIz.ToolbarIcon = chartpieseparate		  tBIz.AddItem(New MenuItem(".csv"))		  tBIz.AddItem(New MenuItem(".xml"))		  		  myLsToolBar.AddBaseMenu(tBI)		  myLsToolBar.AddBaseMenu(tBIz)		  		  		  		  		  //Define a Group		  Dim mGroupID As String = "TestGroup"		  Dim mGroupIDX As String = "TestGroupX"		  DIm tBIg1 As New LsMenuItem("Hello World","GroupBtn_1","TB_G1")		  DIm tBIg2 As New LsMenuItem("I belong to a group","GroupBtn_2","TB_G2")		  DIm tBIg3 As New LsMenuItem("Again","GroupBtn_3","TB_G3")		  DIm tBIg4 As New LsMenuItem("Tada","GroupBtn_4","TB_G4")		  tBIg1.isToolBarItem = True		  tBIg1.showCaption = True		  tBIg1.ToolbarIcon = chartpieseparate		  tBIg1.GroupID = mGroupID		  tBIg1.isPopUpBox = False		  tbig1.isEnabled = False		  tbIg1.HelpTag = "Ich bin ein Hinweis" + EndOfLine + "Der durchaus nützlich sein kann"		  tBIg1.AddItem(New MenuItem(".csv"))		  tBIg1.AddItem(New MenuItem(".xml"))		  tBIg2.isToolBarItem = True		  tBIg2.showCaption = True		  tBIg2.ToolbarIcon = systemmonitor		  tBIg2.GroupID = mGroupID		  tBIg2.isPopUpBox = True		  tBIg2.AddItem(New MenuItem(".csv"))		  tBIg2.AddItem(New MenuItem(".xml"))		  tBIg3.isToolBarItem = True		  tBIg3.showCaption = False		  tBIg3.isPopUpBox = True		  tbIg3.HelpTag ="Noch ein Hinweis"		  tBIg3.ToolbarIcon = chartpieseparate		  tBIg3.GroupID = mGroupID		  tBIg3.AddItem(New MenuItem(".csv"))		  tBIg3.AddItem(New MenuItem(".xml"))		  tBIg4.isToolBarItem = True		  tBIg4.showCaption = True		  tBIg4.ToolbarIcon = bluefolderhorizontal		  tBIg4.GroupID = mGroupIDX		  tBIg4.isPopUpBox = True		  tBIg4.AddItem(New MenuItem(".csv"))		  tBIg4.AddItem(New MenuItem(".xml"))		  		  myLsToolBar.AddBaseMenu(tBIg1)		  myLsToolBar.AddBaseMenu(tBIg2)		  myLsToolBar.AddBaseMenu(tBIx)		  myLsToolBar.AddBaseMenu(tBIg3)		  myLsToolBar.AddBaseMenu(tBIg4)		  		  		  myLsToolBar.AddBaseMenu(tBIy)		  		  myLsToolBar.isActive = true		  myLsToolBar.Refresh()		  		End Sub	#tag EndMethod#tag EndWindowCode#tag Events myLsToolBar	#tag Event		Sub HitMenuItem(menu As LsMenuItem)		  if (menu=nil) then return		  		  console.AddRow("Click on: " + menu.MenuName + " - " + menu.Text)		  console.ListIndex = console.LastIndex		End Sub	#tag EndEvent	#tag Event		Sub PopUpMenu(baseMenu As LsMenuItem, selectedMenu As MenuItem)		  if (basemenu=nil) Or (selectedMenu=Nil) then return		  		  console.AddRow("PopupClick on: " + basemenu.MenuName + " - " + selectedMenu.Text)		  console.ListIndex = console.LastIndex		End Sub	#tag EndEvent	#tag Event		Sub ConsoleLog(cmd As String)		  if cmd.len<1 Then return		  console.AddRow(cmd)		  console.ListIndex = console.LastIndex		End Sub	#tag EndEvent#tag EndEvents#tag Events myLsMenuBar	#tag Event		Sub ConsoleLog(cmd As String)		  if cmd.len<1 Then return		  console.AddRow(cmd)		  console.ListIndex = console.LastIndex		End Sub	#tag EndEvent	#tag Event		Sub PopUpMenu(baseMenu As LsMenuItem, selectedMenu As MenuItem)		  if (basemenu=nil) Or (selectedMenu=Nil) then return		  		  console.AddRow("PopupClick on: " + basemenu.MenuName + " - " + basemenu.Text + " - " + selectedMenu.Text)		  console.ListIndex = console.LastIndex		End Sub	#tag EndEvent	#tag Event		Sub HitMenuItem(menu As LsMenuItem)		  if (menu=nil) then return		  		  console.AddRow("Click on: " + menu.MenuName + " - " + menu.Text)		  console.ListIndex = console.LastIndex		End Sub	#tag EndEvent#tag EndEvents#tag Events BevelButton1	#tag Event		Sub Action()		  'myLsMenuBar.AddSubMenu("File","Öffnen",New MenuItem("Test"))		  myLsMenuBar.ClearSubMenu("File","Öffnen")		End Sub	#tag EndEvent#tag EndEvents#tag Events BevelButton2	#tag Event		Sub Action()		  Dim s() As String = TextArea1.Text.Split(";")		  Dim i,n As Integer		  n = s.Ubound		  if n>-1 Then		    For i=0 to n		      myLsMenuBar.AddSubMenu("File","Öffnen",New MenuItem(s(i)))		    Next		  End If		  		  		End Sub	#tag EndEvent#tag EndEvents