#tag WindowBegin Window changeMenuWin   BackColor       =   15921906   Backdrop        =   ""   CloseButton     =   True   Composite       =   True   Frame           =   1   FullScreen      =   False   HasBackColor    =   True   Height          =   402   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   False   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Symbolleiste anpassen"   Visible         =   True   Width           =   582   Begin Label Label1      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   24      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   "VerfÃ¼gbare Elemente:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "Calibri"      TextSize        =   14      TextUnit        =   0      Top             =   16      Transparent     =   True      Underline       =   ""      Visible         =   True      Width           =   202   End   Begin Label Label2      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   24      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   360      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Aktuelle Elemente:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "Calibri"      TextSize        =   14      TextUnit        =   0      Top             =   16      Transparent     =   True      Underline       =   ""      Visible         =   True      Width           =   202   End   Begin Listbox pMenuList      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   1      ColumnsResizable=   ""      ColumnWidths    =   ""      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   28      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   ""      HeadingIndex    =   -1      Height          =   310      HelpTag         =   ""      Hierarchical    =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      RequiresSelection=   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollBarVertical=   True      SelectionType   =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Calibri"      TextSize        =   14      TextUnit        =   0      Top             =   46      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   202      _ScrollWidth    =   -1   End   Begin Listbox aktMenuList      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   1      ColumnsResizable=   ""      ColumnWidths    =   ""      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   28      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   ""      HeadingIndex    =   -1      Height          =   310      HelpTag         =   ""      Hierarchical    =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   360      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   True      RequiresSelection=   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollBarVertical=   True      SelectionType   =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Calibri"      TextSize        =   14      TextUnit        =   0      Top             =   46      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   202      _ScrollWidth    =   -1   End   Begin PushButton PushButton1      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Ok"      Default         =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   442      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   368      Underline       =   ""      Visible         =   True      Width           =   120   End   Begin PushButton PushButton2      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   True      Caption         =   "Abbrechen"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   310      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   368      Underline       =   ""      Visible         =   True      Width           =   120   End   Begin PushButton PushButton3      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Hinzu ->"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   234      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   61      Underline       =   ""      Visible         =   True      Width           =   113   End   Begin PushButton PushButton4      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "<- Enternen"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   234      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   93      Underline       =   ""      Visible         =   True      Width           =   113   End   Begin PushButton PushButton5      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Nach oben"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   234      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   200      Underline       =   ""      Visible         =   True      Width           =   113   End   Begin PushButton PushButton6      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Nach unten"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   234      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   9      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   232      Underline       =   ""      Visible         =   True      Width           =   113   End   Begin Label Label3      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   24      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   False      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   10      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Technical Preview!"      TextAlign       =   0      TextColor       =   0      TextFont        =   "Calibri"      TextSize        =   12      TextUnit        =   0      Top             =   364      Transparent     =   True      Underline       =   ""      Visible         =   True      Width           =   202   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  'Init()		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Init()		  if parentBaseMenu.Ubound>-1 Then		    		    Dim i,n As Integer		    n = parentBaseMenu.Ubound		    For i=0 to n		      		      		      aktMenuList.addrow parentBaseMenu(i).Text		      if parentBaseMenu(i).ToolbarIcon<>Nil Then		        Dim th,tw As Integer		        th = Min(parentBaseMenu(i).ToolbarIcon.Height,24)		        tw = Min(parentBaseMenu(i).ToolbarIcon.Width,24)		        aktMenuList.RowPicture(aktMenuList.LastIndex) = ScalePicture(parentBaseMenu(i).ToolbarIcon,th,tw)		        aktMenuList.RowPicture(aktMenuList.LastIndex).Mask = ScalePicture(parentBaseMenu(i).ToolbarIcon.Mask,th,tw)		      End If		      aktMenuList.RowTag(aktMenuList.LastIndex) = parentBaseMenu(i)		    Next		    		  End If		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Function ScalePicture(p as Picture, AvailableWidth as Integer, AvailableHeight as Integer) As Picture		  // This method takes a picture and returns a new picture that is scaled to fit within the passed boundaries. The aspect ratio is preserved.		  // The original image is not altered.		  		  dim returnPic as picture		  dim w, h as integer		  dim ratio as double		  		  // Check for nil object		  if p = nil then return nil		  		  // Work out the picture aspect ratio		  ratio = p.Width / p.Height		  		  // Scale depending on aspect ratio		  select case ratio		    		  case 1 ' square image to scale equally		    		    if availableWidth = availableHeight then		      w = availableWidth		      h = availableHeight		    elseif availableWidth < availableHeight then		      w = availableWidth		      h = availableWidth		    elseif availableWidth > availableHeight then		      w = availableHeight		      h = availableHeight		    end if		    		  case is < 1 ' portrait (taller than wider)		    		    if availableWidth <= availableHeight then		      		      h = availableWidth		      		    else		      		      h = availableHeight		      		    end if		    		    w = h * ratio		    		  case is > 1 ' landscape (wider than taller)		    		    if availableWidth <= availableHeight then		      		      w = availableWidth		      		    else		      		      w = availableHeight		      		    end if		    		    h = w / ratio		    		  end select		  		  returnPic = new Picture(w, h, 32)		  returnPic.Graphics.DrawPicture( p, 0, 0, returnPic.Width, returnPic.Height, 0, 0, p.Width, p.Height )		  		  return returnPic		  		End Function	#tag EndMethod	#tag Property, Flags = &h0		parentBaseMenu() As LsMenuItem	#tag EndProperty	#tag Property, Flags = &h0		parentReturnBaseMenu() As LsMenuItem	#tag EndProperty	#tag Property, Flags = &h0		tBaseMenu() As LsMenuItem	#tag EndProperty#tag EndWindowCode#tag Events PushButton1	#tag Event		Sub Action()		  self.close()		End Sub	#tag EndEvent#tag EndEvents