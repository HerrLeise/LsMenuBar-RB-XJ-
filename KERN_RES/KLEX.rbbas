#tag ModuleProtected Module KLEX	#tag Method, Flags = &h0		Function doubleRound(mDouble As Double) As double		  //Rundungsformel		  Dim xDouble As Double = 0.0		  Dim xs() As String = str(mDouble).Split(".")		  if xs.Ubound=1 Then		    xDouble = val(xs(0))		  Else		    Dim ts As String = Format(mDouble,"###.00")		    xDouble = val(ts)		  End If		  		  return val(Format(mDouble,"###.00"))'xDouble		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function GetStringDigits(s As String) As String		  Dim i,n As Integer		  n = s.Len		  if n>0 Then		    Dim ca, cx As String		    		    For i=1 to n		      ca = s.Mid(i,1)		      If isDigitChar(ca) Then cx = cx + ca		    Next		    return cx		  Else		    return "null"		  End IF		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function IIF(condition As Boolean, trueCase As Variant, falseCase As Variant) As Variant		  If condition Then		    Return trueCase		  Else		    Return falseCase		  End If		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub IMM(byREF Extends i As Integer)		  // Increment i-- workaround		  		   i = i - 1		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub IPP(byREF Extends i As Integer)		  // Increment i++ workaround		  		  i = i + 1		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function isDigitChar(a As String) As Boolean		  Dim charCode As Integer = Asc(a.Left(1))		  if (charCode >= 48) and (charcode <= 57) Then		    return true		  else		    return false		  end if		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub ShowInFinder(extends f As FolderItem)		  #if targetwin32 then		    dim s as shell		    s=new shell		    s.execute "explorer /Select,"+f.absolutePath		  #elseif TargetMacOS then		    Dim ae as AppleEvent		    ae = NewAppleEvent("misc", "slct", "MACS")		    		    ae.FolderItemParam("----")=f		    If Not ae.Send Then		      'debug.Msg "MyShowFolder: Couldn't show folder"		    End if		    ae = NewAppleEvent("misc","actv","MACS")		    if not ae.send then		      'debug.Msg "MyShowFolder: Couldn't Activate Finder"		    end if		  #else		    break		  #endif		  		  //Code from: http://forums.realsoftware.com/viewtopic.php?f=1&t=8864&hilit=show+file+in+explorer+select		End Sub	#tag EndMethod	#tag Note, Name = About				KLEX - KERN Language EXtension				------------------------------				Adds some nessecsary methods to the RB/Xojo Language								04.08.15 | ADD | IIF | Replacement for common conditional operator '?'	#tag EndNote	#tag Note, Name = UBound				function Ubound(Extends controlArray As Control) As Integer				  Dim c As Control		  Dim i As Integer		  Dim ub As Integer		  		  ub = -1		  for i=0 to controlArray.window.ControlCount - 1		    c = controlArray.Window.control(i)		    if c.name = controlArray.name Then		      ub = max(ub,c.index)		    End 		  Next		  		  return ub		  		  		  //returns the UBound of a controlarray by using -> ControlName(0).Ubound		  //u always have to provide the first reliable index of your array				End Function	#tag EndNote	#tag ViewBehavior		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Module#tag EndModule